<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link rel="File-List" href="coedinenia_v_zaprosax.files/filelist.xml">
<title>Соединение таблиц в запросах</title>
<style>
<!--
 li.MsoNormal
	{mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	}
-->
</style>
<!--[if !mso]>
<style>
v\:*         { behavior: url(#default#VML) }
o\:*         { behavior: url(#default#VML) }
.shape       { behavior: url(#default#VML) }
</style>
<![endif]--><!--[if gte mso 9]>
<xml><o:shapedefaults v:ext="edit" spidmax="1027"/>
</xml><![endif]-->
</head>

<body>

<table border="3" cellpadding="0" cellspacing="0" width="1200" height="534" style="text-align: justify; text-indent: 20; line-height: 150%; margin: 10 20" background="Fon.jpg" bordercolor="#000080">
	<!-- MSTableType="layout" -->
	<tr>
		<td valign="top">
		<!-- MSCellType="DecArea" -->
		&nbsp;</td>
		<td valign="top" height="72">
		<!-- MSCellType="ContentHead" -->
		&nbsp;<p style="text-align: center"><i><b>
		<font size="5" color="#800080"><a name="Соединение_таблиц_в_запросах_">
		Соединение таблиц в запросах</a></font></b></i></td>
	</tr>
	<tr>
		<td valign="top" width="138">
		<!-- MSCellType="NavBody" -->
		&nbsp;</td>
		<td valign="top" height="462" width="661">
		<!-- MSCellType="ContentBody" -->
		&nbsp;<p><a href="../Page1.htm">В оглавление</a></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-family: 'Times New Roman',serif">Соединение - одна из 
		самых важных и&nbsp; нужных операций, выполняемых реляционными системами 
		управления базами данных. Соединения используются для того, чтобы 
		сопоставить строки одной таблицы строкам другой таблицы.</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		Когда мы хотим видеть данные из нескольких таблиц одновременно, т.е. 
		собрать несколько таблиц в одну возникает понятие соединения таблиц и 
		связей между ними. Соединения бывают четырех типов:</span></p>
		<ul>
			<li>
			<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
			перекрестное соединение;&nbsp;&nbsp;&nbsp;</span></li>
			<li>
			<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">&nbsp;левое;</span></li>
			<li>
			<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
			&nbsp;правое,</span></li>
			<li>
			<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">&nbsp;внутреннее;</span></li>
			<li>
			<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
			&nbsp;полное.</span></li>
		</ul>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		Каждый тип мы рассмотрим на абстрактном примере. </span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-family: 'Times New Roman',serif">1)&nbsp; <i><b>
		Перекрестное соединение</b></i>.</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-family: 'Times New Roman',serif">В базе имеются 2 
		таблицы, справочник &quot;Клиенты&quot; </span></p>
		<table border="1" width="100%">
			<tr>
				<td width="167">Наименование</td>
				<td width="113">Код</td>
				<td width="162">Любимый цвет</td>
				<td>Пол</td>
			</tr>
			<tr>
				<td width="167">Андрей</td>
				<td width="113">01</td>
				<td width="162">Красный</td>
				<td>мужской</td>
			</tr>
			<tr>
				<td width="167">Наташа</td>
				<td width="113">02</td>
				<td width="162">зеленый</td>
				<td>женский</td>
			</tr>
			<tr>
				<td width="167">Петр</td>
				<td width="113">03</td>
				<td width="162">желтый</td>
				<td>мужской</td>
			</tr>
		</table>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-family: 'Times New Roman',serif">и справочник 
		&quot;Ассоциации&quot;</span></p>
		<table border="1" width="23%">
			<tr>
				<td width="122">Цвет</td>
				<td>Наименование</td>
			</tr>
			<tr>
				<td width="122">белый</td>
				<td>снег</td>
			</tr>
			<tr>
				<td width="122">желтый</td>
				<td>солнце</td>
			</tr>
			<tr>
				<td width="122">зеленый</td>
				<td>трава</td>
			</tr>
		</table>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-family: 'Times New Roman',serif">Основываясь на цвете 
		необходимо вывести любимые ассоциации клиентов. Анализ таблиц 
		показывает, что для Наташи и Петра ассоциации есть, а для Андрея нет, 
		потому что они отсутствуют в базе. Тогда запрос будет иметь следующий 
		вид:..</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<font color="#000080">
		<span style="font-family: 'Times New Roman',serif">ВЫБРАТЬ</span></font></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<font color="#000080">
		<span style="font-family: 'Times New Roman',serif">&nbsp;&nbsp;&nbsp;&nbsp; 
		Справочник.Клиенты.Наименование,</span></font></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<font color="#000080">
		<span style="font-family: 'Times New Roman',serif">&nbsp;&nbsp;&nbsp;&nbsp; 
		Справочник.Клиенты.ЛюбимыйЦвет,&nbsp;&nbsp;&nbsp;&nbsp; </span></font>
		</p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<font color="#000080">
		<span style="font-family: 'Times New Roman',serif">&nbsp;&nbsp;&nbsp;&nbsp; 
		Справочник.Ассоциации.Наименование,</span></font></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<font color="#000080">
		<span style="font-family: 'Times New Roman',serif">&nbsp;&nbsp;&nbsp;&nbsp; 
		Справочник.Ассоциации.Цвет</span></font></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<font color="#000080">
		<span style="font-family: 'Times New Roman',serif">ИЗ</span></font></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<font color="#000080">
		<span style="font-family: 'Times New Roman',serif">&nbsp;&nbsp;&nbsp;&nbsp; 
		Справочник.Клиенты,</span></font></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<font color="#000080">
		<span style="font-family: 'Times New Roman',serif">&nbsp;&nbsp;&nbsp;&nbsp; 
		Справочник.Ассоциации</span></font></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		по этому запросу будет сформирована таблица по принципу ПЕРЕКРЕСТНОЕ 
		СОЕДИНЕНИЕ</p>
		<table border="1" width="56%">
			<tr>
				<td width="127">Наименование</td>
				<td width="138">ЛюбимыйЦвет</td>
				<td width="132">Наименование1</td>
				<td>Цвет</td>
			</tr>
			<tr>
				<td width="127">Андрей</td>
				<td width="138">кйрасны</td>
				<td width="132">снег</td>
				<td>белый</td>
			</tr>
			<tr>
				<td width="127">Андрей</td>
				<td width="138">красный</td>
				<td width="132">трава</td>
				<td>зеленый</td>
			</tr>
			<tr>
				<td width="127">Андрей</td>
				<td width="138">красный</td>
				<td width="132">солнце</td>
				<td>желтый</td>
			</tr>
			<tr>
				<td width="127">Наташа</td>
				<td width="138">зеленый</td>
				<td width="132">снег</td>
				<td>белый</td>
			</tr>
			<tr>
				<td width="127">Наташа</td>
				<td width="138">зеленый</td>
				<td width="132">трава</td>
				<td>зеленый</td>
			</tr>
			<tr>
				<td width="127">Наташа</td>
				<td width="138">зеленый</td>
				<td width="132">солнце</td>
				<td>желтый</td>
			</tr>
			<tr>
				<td width="127">Петр</td>
				<td width="138">желтый</td>
				<td width="132">снег</td>
				<td>белый</td>
			</tr>
			<tr>
				<td width="127">Петр</td>
				<td width="138">желтый</td>
				<td width="132">трава</td>
				<td>зеленый</td>
			</tr>
			<tr>
				<td width="127">Петр</td>
				<td width="138">желтый</td>
				<td width="132">солнце</td>
				<td>желтый</td>
			</tr>
		</table>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">2)
		<i><b>Левое соединение.</b></i> Имеется 2 таблицы, в первой храним 
		описательную информацию о номенклатуре, во второй о ее остатках:</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<a href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/tables.png?attredirects=0">
		<b>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: #666666; text-decoration: none"><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Рисунок_x0020_8" o:spid="_x0000_s1033" type="#_x0000_t75"
 alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768134407/13-zaprosy-otcety/zaprosy/tables.png"
 href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/tables.png?attredirects=0"
 style='width:444pt;height:120pt;visibility:visible;mso-wrap-style:square'
 o:button="t">
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="coedinenia_v_zaprosax.files/image001.gif" o:title="tables"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'><a
href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/tables.png?attredirects=0"><img
border=0 width=592 height=160 src="coedinenia_v_zaprosax.files/image001.gif"
alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768134407/13-zaprosy-otcety/zaprosy/tables.png"
title="" v:shapes="Рисунок_x0020_8"></a></span><![endif]></span></b></a></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">&nbsp;</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		<br>
		Для того, чтобы получить из этих таблиц одну нам необходимо явным 
		образом указать какие поля мы будем связывать, по какому условию и типу. 
		Сейчас станет более понятно.</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		Используя левое соединение мы говорим системе, что в результате хотим 
		видеть все записи из левой таблицы и записи из правой удовлетворяющие 
		условию связи. Допустим мы связываем таблицы по полю товар с условием 
		равно, тогда получим таблицу вида:</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<a href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/resultleft.png?attredirects=0">
		<b>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: #666666; text-decoration: none"><!--[if gte vml 1]><v:shape
 id="Рисунок_x0020_7" o:spid="_x0000_s1034" type="#_x0000_t75" alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768262943/13-zaprosy-otcety/zaprosy/resultleft.png"
 href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/resultleft.png?attredirects=0"
 style='width:348.75pt;height:108.75pt;visibility:visible;mso-wrap-style:square'
 o:button="t">
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="coedinenia_v_zaprosax.files/image002.gif" o:title="resultleft"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'><a
href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/resultleft.png?attredirects=0"><img
border=0 width=465 height=145 src="coedinenia_v_zaprosax.files/image002.gif"
alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768262943/13-zaprosy-otcety/zaprosy/resultleft.png"
title="" v:shapes="Рисунок_x0020_7"></a></span><![endif]></span></b></a></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: 12.0pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		<br>
		<span style="color: blue">Запрос</span><span style="color: red">.</span><span style="color: blue">Текст&nbsp;</span><span style="color: red">=</span><br>
		&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black">&quot;ВЫБРАТЬ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура.Товар,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура.Цвет КАК ЦветНоменклатура,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Остатки.Цвет КАК ЦветОстатки,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Остатки.Количество<br>
		&nbsp;&nbsp;&nbsp; |ИЗ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура КАК Номенклатура<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ЛЕВОЕ СОЕДИНЕНИЕ Остатки КАК Остатки<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПО Номенклатура.Товар = Остатки.Товар&quot;</span><span style="color: red">;</span><br>
		<br>
		Для стула не нашлось сопоставлений из таблицы остатков, поэтому поля 
		заполнились значениями NULL, которые обязательно нужно обработать 
		функцией ЕСТЬNULL, см. Функции языка запросов 1С 8.<br>
		<br>
		Левое соединение работает примерно как цикл в цикле - берется первая 
		запись из левой таблицы и пробегаются все записи из правой на предмет 
		удовлетворения условию связи. Затем берется вторая запись из левой 
		таблицы и т.д. Если вдруг условию связи удовлетворяют несколько записей 
		из правой таблицы, то в результирующую таблицу будет добавлено несколько 
		строк (по количеству удачных связей).Как видим, полученная таблица не 
		информативна, данные не отражают реальную суть, поэтому лучше связать 
		эти таблицы по двум полям: Товар и Цвет, только на этот раз обработаем 
		NULL:</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<a href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/resultleft2.png?attredirects=0">
		<b>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: #666666; text-decoration: none"><!--[if gte vml 1]><v:shape
 id="Рисунок_x0020_6" o:spid="_x0000_s1035" type="#_x0000_t75" alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768402578/13-zaprosy-otcety/zaprosy/resultleft2.png"
 href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/resultleft2.png?attredirects=0"
 style='width:262.5pt;height:108.75pt;visibility:visible;mso-wrap-style:square'
 o:button="t">
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="coedinenia_v_zaprosax.files/image003.gif" o:title="resultleft2"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'><a
href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/resultleft2.png?attredirects=0"><img
border=0 width=350 height=145 src="coedinenia_v_zaprosax.files/image003.gif"
alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768402578/13-zaprosy-otcety/zaprosy/resultleft2.png"
title="" v:shapes="Рисунок_x0020_6"></a></span><![endif]></span></b></a></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: blue">
		Запрос</span><span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: red">.</span><span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: blue">Текст&nbsp;</span><span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: red">=</span><span style="font-size: 12.0pt; font-family: 'Times New Roman',serif"><br>
		&nbsp;&nbsp;&nbsp;<span style="color: black">&nbsp;&quot;ВЫБРАТЬ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура.Товар,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура.Цвет,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; ЕСТЬNULL(Остатки.Количество, 0) КАК Количество<br>
		&nbsp;&nbsp;&nbsp; |ИЗ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура КАК Номенклатура<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ЛЕВОЕ СОЕДИНЕНИЕ Остатки КАК Остатки<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПО Номенклатура.Товар = Остатки.Товар<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; И Номенклатура.Цвет = Остатки.Цвет&quot;</span><span style="color: red">;</span></span></p>
		<p class="MsoNormal" style="line-height: normal; margin-top: 12.0pt">
		<span style="font-size: 13.5pt; font-family: 'Times New Roman',serif">3)
		<i><b>Правое соединение.</b></i>&nbsp; </span>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		Правое соединение по сути ничем не отличается от левого. Если поменять 
		таблицы местами, то правое соединение превратится в левое, более того, 
		при использовании конструктора система сама преобразует все правые 
		соединения в левые.</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-top: 12.0pt">
		<span style="font-size: 13.5pt; font-family: 'Times New Roman',serif">4)&nbsp;
		<i><b>Внутреннее соединение</b></i>. </span>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		Используя внутреннее соединение мы говорим системе, что в результате 
		хотим видеть только те записи, которые удовлетворяют условию связи как 
		из правой таблицы, так и из левой. Таким образом, количество 
		результирующих записей будет меньше или равно количеству записей самой 
		&quot;короткой таблицы&quot;, участвующей в соединении. Применим внутреннее 
		соединение к полям Товар и Цвет наших таблиц:</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<a href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result3.png?attredirects=0">
		<b>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: #666666; text-decoration: none"><!--[if gte vml 1]><v:shape
 id="Рисунок_x0020_5" o:spid="_x0000_s1036" type="#_x0000_t75" alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768533221/13-zaprosy-otcety/zaprosy/result3.png"
 href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result3.png?attredirects=0"
 style='width:200.25pt;height:63pt;visibility:visible;mso-wrap-style:square'
 o:button="t">
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="coedinenia_v_zaprosax.files/image004.gif" o:title="result3"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'><a
href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result3.png?attredirects=0"><img
border=0 width=267 height=84 src="coedinenia_v_zaprosax.files/image004.gif"
alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768533221/13-zaprosy-otcety/zaprosy/result3.png"
title="" v:shapes="Рисунок_x0020_5"></a></span><![endif]></span></b></a></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		<br>
		<span style="color: blue">Запрос</span><span style="color: red">.</span><span style="color: blue">Текст&nbsp;</span><span style="color: red">=</span><br>
		&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black">&quot;ВЫБРАТЬ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура.Товар,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура.Цвет,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Остатки.Количество КАК Количество<br>
		&nbsp;&nbsp;&nbsp; |ИЗ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; Номенклатура КАК Номенклатура<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ВНУТРЕННЕЕ СОЕДИНЕНИЕ Остатки КАК Остатки<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПО Номенклатура.Товар = Остатки.Товар<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; И Номенклатура.Цвет = Остатки.Цвет&quot;</span><span style="color: red">;</span></span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">&nbsp;</p>
		<p class="MsoNormal" style="line-height: normal; margin-top: 12.0pt">
		<span style="font-size: 13.5pt; font-family: 'Times New Roman',serif">5)
		<i><b>Полное соединение. </b></i>&nbsp;</span><span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">Полное 
		соединение передаст в результат все записи из обоих таблиц, те записи, 
		которые удовлетворяет условию связи - будут связаны, те записи, которые 
		не удовлетворяют условию связи все равно окажутся в результате запроса, 
		но с частью NULLовых полей. Полное это как бы левое и правое соединения 
		в одном.<br>
		<br>
		Задач на эту тему может быть много, давайте попробуем решить одну из 
		них. Наша организация является дилером 2 мебельных фабрик: &quot;Заря&quot; и 
		&quot;Рассвет&quot;. Ассортимент со стоимостью каждой из фабрик хранится в разных 
		таблицах. Необходимо составить единый прайс лист, причем брать в него 
		продукцию по минимальной цене:</span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<a href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/tables4.png?attredirects=0">
		<b>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: #666666; text-decoration: none"><!--[if gte vml 1]><v:shape
 id="Рисунок_x0020_4" o:spid="_x0000_s1037" type="#_x0000_t75" alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768679312/13-zaprosy-otcety/zaprosy/tables4.png"
 href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/tables4.png?attredirects=0"
 style='width:365.25pt;height:89.25pt;visibility:visible;mso-wrap-style:square'
 o:button="t">
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="coedinenia_v_zaprosax.files/image005.gif" o:title="tables4"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'><a
href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/tables4.png?attredirects=0"><img
border=0 width=487 height=119 src="coedinenia_v_zaprosax.files/image005.gif"
alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768679312/13-zaprosy-otcety/zaprosy/tables4.png"
title="" v:shapes="Рисунок_x0020_4"></a></span><![endif]></span></b></a></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: 12.0pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		Применим полное соединение с выборкой всех полей, связывать будем по 
		товару:<br>
		<br>
		<span style="color: blue">Запрос</span><span style="color: red">.</span><span style="color: blue">Текст&nbsp;</span><span style="color: red">=</span><br>
		&nbsp;&nbsp;&nbsp; &quot;ВЫБРАТЬ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; НоменклатураЗаря.Товар КАК ТоварЗаря,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; НоменклатураЗаря.Цена КАК ЦенаЗаря,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; НоменклатураРассвет.Товар КАК ТоварРассвет,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; НоменклатураРассвет.Цена КАК ЦенаРассвет<br>
		&nbsp;&nbsp;&nbsp; |ИЗ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; НоменклатураЗаря КАК НоменклатураЗаря<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПОЛНОЕ СОЕДИНЕНИЕ НоменклатураРассвет КАК 
		НоменклатураРассвет<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПО НоменклатураЗаря.Товар = НоменклатураРассвет.Товар&quot;<span style="color: red">;</span></span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<a href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result4.png?attredirects=0">
		<b>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: #666666; text-decoration: none"><!--[if gte vml 1]><v:shape
 id="Рисунок_x0020_3" o:spid="_x0000_s1038" type="#_x0000_t75" alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768798744/13-zaprosy-otcety/zaprosy/result4.png"
 href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result4.png?attredirects=0"
 style='width:319.5pt;height:93pt;visibility:visible;mso-wrap-style:square'
 o:button="t">
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="coedinenia_v_zaprosax.files/image006.gif" o:title="result4"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'><a
href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result4.png?attredirects=0"><img
border=0 width=426 height=124 src="coedinenia_v_zaprosax.files/image006.gif"
alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768798744/13-zaprosy-otcety/zaprosy/result4.png"
title="" v:shapes="Рисунок_x0020_3"></a></span><![endif]></span></b></a></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: 12.0pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		<br>
		Это не совсем то, что нам нужно, давайте соединим поле товар в одно и 
		обработаем NULLы:<br>
		<br>
		<span style="color: blue">Запрос</span><span style="color: red">.</span><span style="color: blue">Текст&nbsp;</span><span style="color: red">=</span><br>
		&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black">&quot;ВЫБРАТЬ<br>
		&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #274E13">//конструкция ЕСТЬNULL 
		рассматривалась в разделе функции языка запросов</span><span style="color: black"><br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; ЕСТЬNULL(НоменклатураЗаря.Товар, НоменклатураРассвет.Товар) КАК 
		Товар,<br>
		&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #274E13">//если цена не определена, то 
		инициализируем ее<br>
		&nbsp;&nbsp;&nbsp; //почему 1000000 см. пояснения ниже</span><span style="color: black"><br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; ЕСТЬNULL(НоменклатураЗаря.Цена, 1000000) КАК ЦенаЗаря,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; ЕСТЬNULL(НоменклатураРассвет.Цена, 1000000) КАК ЦенаРассвет<br>
		&nbsp;&nbsp;&nbsp; |ИЗ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; НоменклатураЗаря КАК НоменклатураЗаря<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПОЛНОЕ СОЕДИНЕНИЕ НоменклатураРассвет КАК 
		НоменклатураРассвет<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПО НоменклатураЗаря.Товар = НоменклатураРассвет.Товар&quot;</span><span style="color: red">;</span></span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<a href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result5.png?attredirects=0">
		<b>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: #666666; text-decoration: none"><!--[if gte vml 1]><v:shape
 id="Рисунок_x0020_2" o:spid="_x0000_s1039" type="#_x0000_t75" alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768877400/13-zaprosy-otcety/zaprosy/result5.png"
 href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result5.png?attredirects=0"
 style='width:222pt;height:92.25pt;visibility:visible;mso-wrap-style:square'
 o:button="t">
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="coedinenia_v_zaprosax.files/image007.gif" o:title="result5"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'><a
href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result5.png?attredirects=0"><img
border=0 width=296 height=123 src="coedinenia_v_zaprosax.files/image007.gif"
alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768877400/13-zaprosy-otcety/zaprosy/result5.png"
title="" v:shapes="Рисунок_x0020_2"></a></span><![endif]></span></b></a></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: 12.0pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">
		Осталось только выбрать минимальную цену. Итоговый тект запроса будет 
		выглядеть следующим образом:<br>
		<br>
		<span style="color: blue">Запрос</span><span style="color: red">.</span><span style="color: blue">Текст&nbsp;</span><span style="color: red">=</span><br>
		&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black">&quot;ВЫБРАТЬ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; ЕСТЬNULL(НоменклатураЗаря.Товар, НоменклатураРассвет.Товар) КАК 
		Товар,<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; ВЫБОР<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; КОГДА ЕСТЬNULL(НоменклатураЗаря.Цена, 1000000) &gt; ЕСТЬNULL(НоменклатураРассвет.Цена, 
		1000000)<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ТОГДА ЕСТЬNULL(НоменклатураРассвет.Цена, 1000000)<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ИНАЧЕ ЕСТЬNULL(НоменклатураЗаря.Цена, 1000000)<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; КОНЕЦ КАК Цена<br>
		&nbsp;&nbsp;&nbsp; |ИЗ<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; НоменклатураЗаря КАК НоменклатураЗаря<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПОЛНОЕ СОЕДИНЕНИЕ НоменклатураРассвет КАК 
		НоменклатураРассвет<br>
		&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ПО НоменклатураЗаря.Товар = НоменклатураРассвет.Товар&quot;</span><span style="color: red">;</span></span></p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<a href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result6.png?attredirects=0">
		<b>
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif; color: #666666; text-decoration: none"><!--[if gte vml 1]><v:shape
 id="Рисунок_x0020_1" o:spid="_x0000_s1040" type="#_x0000_t75" alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768942999/13-zaprosy-otcety/zaprosy/result6.png"
 href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result6.png?attredirects=0"
 style='width:156pt;height:93.75pt;visibility:visible;mso-wrap-style:square'
 o:button="t">
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="coedinenia_v_zaprosax.files/image008.gif" o:title="result6"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout'><a
href="https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/result6.png?attredirects=0"><img
border=0 width=208 height=125 src="coedinenia_v_zaprosax.files/image008.gif"
alt="Описание: https://sites.google.com/site/1sspravocniktipovyhzadac/_/rsrc/1410768942999/13-zaprosy-otcety/zaprosy/result6.png"
title="" v:shapes="Рисунок_x0020_1"></a></span><![endif]></span></b></a></p>
		<p class="MsoNormal">
		<span style="font-size: 12.0pt; line-height: 115%; font-family: 'Times New Roman',serif">
		<br>
		Если цена не определена (NULL), то ее необходимо инициализировать каким 
		либо значением, иначе операция сравнения на больше/меньше вывалится с 
		ошибкой. инициализируем цену нереально большой суммой, чтобы она 
		&quot;проиграла&quot; в операции сравнения, ведь по условию задачи мы подбираем 
		наименьшую цену.</span></p>
		<p class="MsoNormal"><span style="font-family: 'Times New Roman',serif">
		<a href="#Соединение_таблиц_в_запросах_">В начало</a></span></p>
		<p><a href="../Page1.htm">В оглавление</a></p>
		<p class="MsoNormal">&nbsp;</p>
		<p class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt">
		<span style="font-size: 12.0pt; font-family: 'Times New Roman',serif">&nbsp;https://sites.google.com/site/1sspravocniktipovyhzadac/13-zaprosy-otcety/zaprosy/soedinenie-tablic-v-zaprosah</span></p>
		<span style="font-size: 12.0pt; line-height: 115%; font-family: 'Times New Roman',serif">
		Автор: Дмитрий Котельников<br>
		<br>
&nbsp;</span><p class="MsoNormal">&nbsp;</p>
		<p>&nbsp;</td>
	</tr>
</table>

</body>

</html>
