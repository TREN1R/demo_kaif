<html>

<head>
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>Лабораторная работа №8</title>
</head>

<body>

<table border="2" cellpadding="0" cellspacing="0" background="Fon.jpg" bordercolor="#000080" style="line-height: 150%; margin-top: 12; margin-bottom: 5; padding-left:20px; padding-right:10px; padding-top:20px; padding-bottom:20px" width="1645" height="9388">
	<!-- MSTableType="layout" -->
	<tr>
		<td valign="top" style="text-indent: 0; text-align: center; margin-left: 30; margin-top: 15" colspan="2">
		<!-- MSCellType="ContentHead" -->
		&nbsp;<p><b><font size="6" color="#800080">Лабораторная работа №8-1. 
		Создание внешней обработки</font></b></p>
		<p><font size="6" color="#800080"><b>части 1-3</b></font></p>
		<p>&nbsp;</td>
		<td height="149">&nbsp;</td>
	</tr>
	<tr>
		<td valign="top" width="173">
		<!-- MSCellType="NavBody" -->
		&nbsp;<p><a href="#Обработка">Обработка (теория)</a></p>
		<p><a href="#Описание_процедуры_ИмяФайлаНачалоВыбора._">Процедура 
		ИмяФайлаНачалоВыбора</a></p>
		<p><a href="#Описание_процедуры_ПрочитатьExcel.">Процедура Прочитать<span lang="en-us">Excel</span></a><p>
		<a href="#Описание_процедуры_РаботаСExcel1_()">Процедура РаботаС<span lang="en-us">Excel</span></a><p>
		<a href="#Описание_процедуры_ПерейтиНаСервер_()">Процедура 
		ПерейтиНаСервер</a><p><a href="#Контрольные_вопросы_№1">Контрольные вопросы №1</a><p>
		<a href="#Контрольные_вопросы_№2_">Контрольные вопросы №2</a><p>
		<a href="#Контрольные_вопросы_№3_">Контрольные вопросы №3</a></td>
		<td valign="baseline" style="line-height: 150%; margin: 0; padding-left: 15px; padding-right: 6px; padding-top: 15px" width="1110">
		<!-- MSCellType="ContentBody" -->
		<p><a href="../Page1.htm">В оглавление</a></p>
		<p>К контрольным вопросам по части 1</p>
		<p>К контрольным вопросам по части 2.</p>
		<p><b><font size="5">Часть 1. </font><font size="4">Чтение информации из
		<span lang="en-us">Excel</span> файла и отображение ее в виде таблицы</font></b></p>
		<p><b>Техническое задание</b></p>
		<p>Требуется создать внешнюю обработку, считывающую информацию из файла
		<span lang="en-us">Excel</span> и записывающая считанную информацию в 
		файл <span lang="en-us">Excel.</span></p>
		<p><b>Рекомендации к решению</b></p>
		1. Откройте конфигуратор и последовательностью Файл-Новый в окне &quot;Выбор 
		вида документа&quot;&nbsp; создайте объект Внешняя обработка, рисунок 1.<p align="center">
		<img border="0" src="lab8a-1.jpg"></p>
		<p align="center">Рисунок 1 - Создание внешней обработки</p>
		<p align="justify">2. Включите в состав обработки реквизит <b>ИмяФайла</b>, 
		тип Строка неограниченной длины. Создайте форму объекта, в свойствах 
		поля <b>ИмяФайла</b> укажите, что это поле имеет кнопку выбора и кнопку 
		очистки. Добавьте кнопку <b>Прочитать<span lang="en-us">Excel</span></b> 
		и перенесите ее в форму, рисунок 2. Сохраните созданную обработку в той 
		же самой БД, с которой Вы работаете. Сохранение внешней обработки 
		выполняется методом <b>Сохранить как....</b><span lang="en-us"> </span>
		Обработку сохраните в папке, где хранится ваша БД. В дальнейшем, при 
		каждой модификации обработки, используйте кнопку <b>СОХРАНИТЬ</b>
		<img border="0" src="lab8a-5.gif">. При таком методе работы Ваша 
		конфигурация не изменяется, она вам нужна только для создания и проверки 
		созданной обработки.</p>
		<p align="center"><img border="0" src="lab8a-2.jpg"></p>
		<p align="center">Рисунок 2 - Создание кнопки</p>
		<p>3. Закрепите за полем <b>ИмяФайла</b> процедуру, рисунок 3.</p>
		<p align="center"><img border="0" src="lab8a-3.jpg"><img border="0" src="lab8a-4.gif"></p>
		<p align="center">Рисунок 3 - Процедура, привязанная к реквизиту <b>
		ИмяФайла</b></p>
		<p><a name="Описание_процедуры_ИмяФайлаНачалоВыбора._">Описание 
		процедуры <b>ИмяФайлаНачалоВыбора</b>. </a></p>
		<blockquote>
			<p>1)&nbsp; Методом НОВЫЙ создается диалоговое окно, предназначенное 
			для выбора файла с заданным режимом работы, который&nbsp; содержит 
			варианты диалога выбора файла. Используется для определения свойства 
			режим. В нашем случае режим будет <b>Открытие.</b></p>
			<p>2)&nbsp; Формируется заголовок диалогового окна и в реквизит 
			объекта <b>ИмяФайла</b> заносится полный путь доступа к файлу.</p>
		</blockquote>
		<p>4. Привяжите к созданной кнопке процедуру, рисунок 4.</p>
		<p><img border="0" src="lab8a-6.gif"></p>
		<p align="center">Рисунок 4 - Процедура, привязанная к кнопке</p>
		<p align="left"><a name="Описание_процедуры_ПрочитатьExcel.">Описание 
		процедуры <b>Прочитать<span lang="en-us">Excel.</span></b></a><span lang="en-us"><b>
		</b></span></p>
		<blockquote>
			<p align="left">1)&nbsp; Создается новый СОМ объект&nbsp; 
			Excel.Application. Этому объекту передается команда ОТКРЫТЬ файл, 
			адрес которого находится в поле <b>ИмяФайла</b> с указанием открыть 
			первый лист.</p>
			<p align="left">2)&nbsp; Создается НОВЫЙ объект Табличный документ, 
			предназначен для создания&nbsp; форм первичных документов.</p>
			<div id="V8TextArea" valign="bottom">
				3)&nbsp; Производится активация страницы <span lang="en-us">
				Excel. </span>Активация производится для версии
				<span lang="en-us">Excel </span>выше 2008 года ( параметр 
				xlLastCell = 11 принимает значение 11)<p>4) Определяется 
				количество заполненных строк и столбцов в активной странице
				<img border="0" src="lab8a-11.gif"></p>
				<p>5)&nbsp; Определяются границы области, которая будет 
				выводиться в табличный документ. Границы определяются также как 
				и в <span lang="en-us">Excel</span>, в виде<b> </b>
				<span lang="en-us"><b>RxCy:RxmCyn.</b> </span>Где символом
				<span lang="en-us">&quot;R</span>&quot;<span lang="en-us"> </span>&nbsp;обозначается 
				строка, а символом &quot;С&quot; колонка, за обозначением указывается 
				номер строки и номер колонки ячейки левого верхнего угла 
				области, затем через двоеточие адрес ячейки правого нижнего угла 
				области.</p>
				<p>6)&nbsp; Определяется ширина колонок, куда будет выводиться 
				информация. <img border="0" src="lab8a-12.gif"><a href="EXCEL.htm#Свойства,__методы_и_функции_для_работы_с_Excel_">&nbsp;&nbsp;
		Дополнительные возможности <span lang="en-us">Excel</span> для работы в 
		среде 1С</a> можно посмотреть по этой ссылке.&nbsp;&nbsp; Параметр &quot;ЧГ&quot; 
				функции Формат задает требование установить ширину колонки. 
				Ширина устанавливается по размерам колонки <span lang="en-us">
				Excel</span>. Конструкцией <img border="0" src="lab8a-14.gif">читается 
				заголовок колонки.</p>
				<p>7)&nbsp; Создается двойной цикл по строкам, а внутри по 
				колонкам, где формируются строки выводимого документа путем 
				прочтения каждой ячейки, входящую в состав строки
				<img border="0" src="lab8a-15.gif"></p>
				<p>8)&nbsp; Закрывается книга <span lang="en-us">Excel</span> и 
				выводится в буфер область, размеры которой были заданы в начале 
				процедуры, затем эта область из буфера выводится на рабочий стол 
				с именем &quot;Таблица <span lang="en-us">EXCEL</span>&quot;.</div>
		</blockquote>
		<p align="left">5. Создайте файл Е<span lang="en-us">xcel</span> с 
		именем &quot;Товары&quot; и занесите в него следующую информацию, рисунок 5. Файл 
		сохраните в папке с Вашей БД с расширением <b>.<span lang="en-us">xls</span></b></p>
		<p align="left"><b>Примечание. </b>При создании таблицы не допускается 
		объединять несколько ячеек в одну.</p>
		<p align="center"><img border="0" src="lab8a-13.jpg"></p>
		<p align="center">Рисунок 5 - Текст файла &quot;Товары&quot;</p>
		<p align="left">6. Откройте режим пользователя и из него откройте Вашу 
		обработку <b>(Главное меню - Файл - Открыть</b>), рисунок 6.</p>
		<p align="center"><img border="0" src="lab8a-8.jpg"></p>
		<p align="center">Рисунок 6 - Открытие внешней обработки</p>
		<p align="left">7. Введите в окне обработке адрес созданного вами файла 
		и с помощью кнопки <b>Прочитать <span lang="en-us">Excel</span></b> 
		прочитайте файл и отобразите его в окне рабочего стола., рисунок 7.</p>
		<p align="left"><img border="0" src="lab8a-9.jpg" align="left"><img border="0" src="lab8a-16.jpg"></p>
		<p align="center">Рисунок 7 Сформированная таблица</p>
		<p><b><u>Самостоятельно №1</u>&nbsp; </b></p>
		<blockquote>
			<p><b>1)&nbsp; </b>Сохраните созданный вами файл <span lang="en-us">
			Excel c </span>расширением<span lang="en-us"> </span>&nbsp;<b>.<span lang="en-us">xlsx</span> 
			, </b>откройте созданную обработку, выберите для отображения файл с 
			расширением <b><span lang="en-us">.xlsx</span></b> и попробуйте его 
			вывести на экран.</p>
			<p>2)&nbsp; Включите в состав обработки еще одну кнопку. Кнопку 
			свяжите с аналогичной процедурой, но без цикла, определяющего ширину 
			колонок. Что получилось и почему?</p>
			<p>&nbsp;</p>
		</blockquote>
		<p><b><a name="Контрольные_вопросы_№1">Контрольные вопросы №1</a></b></p>
		<ol>
			<li>Дайте определение объекта ОБРАБОТКА. Какого типа обработки Вы 
			знаете?</li>
			<li>Какие виды работ можно выполнять с помощью обработок?</li>
			<li>Чем внешняя обработка отличается от внутренней?</li>
			<li>С помощью какого метода можно создать диалоговое окно для выбора 
			нужного файла?</li>
			<li>Как включить кнопку в состав диалогового окна? И как ее 
			&quot;оживить&quot;?</li>
			<li>Какую роль играет <a href="COM-object.htm"><span lang="en-us">
			COM</span> объект</a>, использованный в этой процедуре? </li>
			<li>Каким образом определяются границы секции, в которой будет 
			формироваться таблица?</li>
			<li>Какой используется метод для установки границы колонки?</li>
			<li>Каким образом происходит формирование строк выходной таблицы?</li>
		</ol>
		<p><b><font size="5">Часть 2. </font><font size="4">Чтение информации из
		<span lang="en-us">Excel</span> файла и запись ее в справочник</font></b></p>
		<p>8. Создайте в конфигураторе справочник Товары, рисунок 8. Все 
		реквизиты должны иметь примитивный тип (число, строка, дата, булево).</p>
		<p align="center"><img border="0" src="lab8a-17.gif"> </p>
		<p align="center">Рисунок 8 - Структура справочника</p>
		<p align="left">9. Добавьте в ранее созданную обработку еще одну кнопку 
		<b>Работа с </b> <span lang="en-us"><b>Excel</b> </span>и закрепите за ней процедуру, 
		рисунок 9. Так как вновь созданная кнопка предназначена не только для 
		чтения файла <span lang="en-us">Excel</span>, но и записи информации из 
		него в справочник&nbsp; &quot;Товары&quot;, то потребуется создание и серверной 
		процедуры, в которой будут формироваться записи справочника, рисунок 10.</p>
		<p align="center"><img border="0" src="lab8a-18.jpg"><img border="0" src="lab8a-19.gif"></p>
		<p align="center">Рисунок 9 - Процедура, обрабатывающая кнопку &quot;Работа с
		<span lang="en-us">Excel</span>&quot;</p>
		<p align="left"><a name="Описание_процедуры_РаботаСExcel1_()">Описание процедуры <b>РаботаС<span lang="en-us">Excel1</span> 
		()</b></a></p>
		<blockquote>
			<p align="left">1)&nbsp; Создается новый <span lang="en-us">COM</span> 
			объект для работы с файлом <span lang="en-us">Excel</span> и 
			открывается файл. Конструкция <b>ActiveCell.Column </b>позволяет 
			определить число колонок в считанном файле. Получаем доступ к 
			первому листу файла <span lang="en-us">Excel</span>.</p>
			<p align="left">2)&nbsp; Создаем массив для переноса таблицы из 
			файла <span lang="en-us">Excel</span> в этот массив. После переноса 
			таблицы в&nbsp; массив файл <span lang="en-us">Excel </span>
			закрываем.<img border="0" src="lab8a-1.gif"></p>
			<p align="left">3)&nbsp; В переменную МассивКолонок Помещаем ссылку 
			на область, куда выгружена вся таблица. В переменную Всего строк 
			помещаем количество строк таблицы минус строку заголовка.<img border="0" src="lab8a-2.gif"></p>
			<p align="left">4)&nbsp; Происходит обращение к серверной процедуре
			<b>ПерейтиНаСервер</b>. Этой процедуре передаются три параметра: 
			адрес, по которому находится в оперативной памяти считанная таблица, 
			число строк и число колонок таблицы.</p>
		</blockquote>
		<p align="center"><img border="0" src="lab8a-20.gif"></p>
		<p align="center">Рисунок 10 - Серверная процедура</p>
		<p align="left"><a name="Описание_процедуры_ПерейтиНаСервер_()">Описание процедуры <b>ПерейтиНаСервер ()</b></a></p>
		<blockquote>
			<p align="left">1)&nbsp; Создается новый массив, ссылка на него 
			помещается в переменную ЭлементыСтроки.</p>
			<p align="left">2)&nbsp; Организуется два цикла: первый по строкам, 
			второй по колонкам. Так как первая строка нам не нужна, потому что 
			она является заголовком таблицы, поэтому количество циклов по 
			строкам уменьшаем на 1. Из таблицы также не будем использовать 
			первую колонку с номером, значит количество циклов по колонкам также 
			уменьшаем на 1. Так как в массиве все элементы нумеруются с &quot;нуля&quot;, 
			то производим перебор строк и колонок начиная с первого элемента. В 
			цикле первого уровня создается новая строка справочника &quot;Товары&quot;.</p>
			<p align="left"><img border="0" src="lab8a-3.gif"></p>
			<p align="left">3)&nbsp; После заполнения очередной строки массива 
			происходит перенос элементов массива в справочник. По окончании 
			переноса заполненная строка справочника записывается, а массив 
			очищается для формирования очередной строки.</p>
			<p align="left"><img border="0" src="lab8a-7.gif"></p>
		</blockquote>
		<p align="left">10.&nbsp; Перейдите режим пользователя, методом Файл- 
		Открыть откройте обработку и проверьте работу кнопки Работа с
		<span lang="en-us">Excel</span>, рисунок 11. Откройте справочник 
		&quot;Товары&quot; и проверьте появившиеся в нем записи.</p>
		<p align="center"><img border="0" src="lab8a-5.jpg"><img border="0" src="lab8a-6.jpg"></p>
		<p align="center">Рисунок 11 - Результаты работы процедуры &quot;Работа с
		<span lang="en-us">Excel</span>&quot;</p>
		<p align="left"><b>Примечание.</b> Для переноса информации из
		<span lang="en-us">Excel</span> в справочник надо очень хорошо 
		проанализировать структуру справочника и структуру таблицы
		<span lang="en-us">Excel</span>. Она должна совпадать. </p>
		<p align="left"><a href="../Page1.htm">В оглавление</a></p>
		<p align="left"><b><a name="Контрольные_вопросы_№2_">Контрольные вопросы №2</a></b></p>
		<ol>
			<li>
			<p align="left">Расскажите последовательность действий создания 
			кнопки и переноса ее в форму.</p></li>
			<li>
			<p align="left">Какого типа должны быть реквизиты справочника, 
			заполняемого <span lang="en-us">и</span>з <span lang="en-us">Excel</span>?</p></li>
			<li>
			<p align="left">Для каких целей в процедуре был использован
			<span lang="en-us">COM</span> объект?</p></li>
			<li>
			<p align="left">Почему процедуру &quot;Работа с <span lang="en-us">Excel</span>&quot; 
			разбили на две части, под клиентом и под сервером? Можно ли было 
			обойтись одной клиентской процедурой?</p></li>
			<li>
			<p align="left">Правила передачи параметров и какие параметры были 
			переданы от одной процедуре к другой и для чего?</p></li>
			<li>
			<p align="left">Какого типа обработки Вы знаете? В чем их различие?</p></li>
		</ol>
		<p align="left"><b><font size="5">Часть <span lang="en-us">3</span>. </font><font size="4">Чтение информации из
		текстового файла и запись ее в справочник</font></b></p>
		<p align="left">Файлы, созданные с помощью приложения БЛОКНОТ, считаются 
		созданными в универсальном текстовом формате,
		<span style="font-size: 12.0pt; line-height: 107%; font-family: 'Open Sans',sans-serif; color: black">
		CSV, (от английского Comma-Separated Values). Они </span>
		<span style="font-size: 12.0pt; font-family: 'Open Sans',sans-serif; color: black">
		предназначены для типизации табличных данных. В этом формате колонки 
		отделяются специальными символами — разделителями. Разделителями чаще 
		всего служат символы «;»(точка с запятой) , «,»(запятая) или табуляция 
		(системное значение «Символы.Таб» в 1С 8). Загрузка из CSV в 1С чаще 
		всего нужна, чтобы загрузить данные в систему из внешнего источника, 
		например, сайта или другой учетной системы. </span>
		<span style="font-size: 13.5pt; line-height: 107%; font-family: 'Open Sans',sans-serif; color: black">
		CSV, по сути, — обыкновенный текст, в котором указаны данные. Обычно в 
		первой строке обозначены названия колонки, во второй и далее — данные.</span></p>
		<p align="left">11. Создайте текстовый файл в блокноте, рисунок 12, и 
		сохраните его в той же папке, что и основная БД. </p>
		<p align="center"><img border="0" src="lab8a-4.jpg"></p>
		<p align="center">Рисунок 12 - Текстовый файл</p>
		<p align="left">12. Анализ текстового файла показывает, что его первая 
		строка показывает наименования заголовков, то есть имена реквизитов, в 
		которые должны заноситься данные: <b>Main Code</b> соответствует коду 
		изделия; <b>Price</b> - наименованию изделия; реквизиты <b>Price 
		Code;Price Name;Price Platform</b> - это оригинальные наименования&nbsp; 
		реквизитов, характеризующие каждый элемент. Создайте новый справочник с 
		именем <b>Пробный</b>, проанализируйте длину всех кодов и наименований 
		на максимальное в них количество символов и внесите корректировку в 
		справочник. Аналогичным образом подсчитайте максимальную длину всех 
		данных. Визуальный анализ показывает, что вся информация текстовая, но 
		последние два реквизита могут иметь неограниченную длину, так как 
		содержат характеристики и описание товара. Выполненный анализ показал, 
		что стандартная длина реквизитов Код и Наименование достаточна, 
		реквизиту PriceCode присвоим длину 20, а для остальных реквизитов 
		задайте неограниченную длину, рисунок 13.</p>
		<p align="center"><img border="0" src="lab8a-12.jpg"></p>
		<p align="center">Рисунок 13 - Создание справочника Пробный</p>
		<p align="left">13.&nbsp; Создайте внешнюю обработку с именем <b>Чтение</b><span lang="en-us"><b>_CSV</b>
		</span>с единственным реквизитом <b>ИмяФайла</b> и кнопкой <b>Прочитать<span lang="en-us">CSV</span></b>, 
		рисунок 14.</p>
		<p align="left"><img border="0" src="lab8a-11.jpg"></p>
		<p align="center">Рисунок 14 - Создание внешней обработки</p>
		<p align="left">14. Откройте модуль формы обработки и напишите текст 
		процедур:</p>
		<p align="left">а)&nbsp; процедура открытия диалога выбора файла, 
		рисунок 15. Описание процедуры
		<a href="#Описание_процедуры_ИмяФайлаНачалоВыбора._">
		ИмяФайлаНачалоВыбора</a></p>
		<p align="center">&nbsp;<img border="0" src="lab8a-8.gif"></p>
		<p align="center">Рисунок 15 - Процедура открытия диалога</p>
		<p align="left">б) процедура <b>Прочитать<span lang="en-us">CSV</span>()</b>, 
		привязанная к кнопке <b>Прочитать<span lang="en-us">CSV</span></b>, 
		рисунок 16. Эта процедура вызывает функцию <b>
		РазложитьСтрокуВМассивПодстрок() </b>и процедуру&nbsp; <b>
		ПрочитатьCSVНаСервере(). </b>Первая преобразовывает очередную строку 
		текстового файла путем отбрасывания служебных символов (разделителей), 
		вторая создает новую строку справочника и записывает в его реквизиты 
		переданные значения.</p>
		<p align="center"><img border="0" src="lab8a-14.jpg"></p>
		<p align="center">Рисунок 16 - Процедура, привязанная к кнопке</p>
		<p align="left">в)&nbsp; процедура&nbsp; <b>ПрочитатьCSVНаСервере()</b>, 
		формирует строки справочника, рисунок 17.</p>
		<p align="center"><img border="0" src="lab8a-9.gif"></p>
		<p align="center">Рисунок 17 - Текст процедуры ПрочитатьCSVНаСервере()</p>
		<p>г)&nbsp; функция <b>РазложитьСтрокуВМассивПодстрок(), </b>отбрасывает 
		разделители и формирует&nbsp; массив с информацией по реквизитам, 
		рисунок 18.</p>
		<p align="center"><img border="0" src="lab8a-10.gif"></p>
		<p align="center">Рисунок 18 - Текст функции 
		РазложитьСтрокуВМассивПодстрок()</p>
		<p align="left">Описание функции<b> РазложитьСтрокуВМассивПодстрок().</b> 
		Функции передается два параметра, первый параметр передает не ссылку на 
		область, в которой находится считанная строка, а сами значения, 
		находящиеся в этой строке. Второй параметр передает символ, который 
		играет роль разделителя. Создается массив для размещения в нем 
		поэлементно&nbsp; значений реквизитов, &quot;очищенных&quot; от разделителей. 
		Строка <b>Пока Истина Цикл </b>&nbsp;проверяет наличие в области <b>Стр</b> 
		информации. Цикл закончится когда вся информации будет выбрана.<br>
&nbsp;</p>
		<p align="left"><span lang="en-us">15</span>.&nbsp; Добавьте в форму еще 
		одну кнопку, рисунок 19 и привяжите к ней процедуру.</p>
		<p align="center"><img border="0" src="lab8a-15.jpg"><img border="0" src="lab8a-13.gif"><img border="0" src="lab8a-16.gif"></p>
		<p align="center">Рисунок 19 - Создание кнопки <b>Выгрузить в
		<span lang="en-us">CSV</span></b></p>
		<p align="left">16.&nbsp; Как видно из рисунка процедура <b>Выгрузка()</b> 
		обращается к функциям <b>СоздатьДанные<span lang="en-us">CSV()</span></b> 
		и<b> Записать<span lang="en-us">CSV</span>(</b>), <b>ПолучитьКонтрагенты()</b>, 
		рисунок 20.</p>
		<p align="left"><img border="0" src="lab8a-18.gif" align="left"> </p>
		<p>
		<img border="0" src="lab8a-21.gif" align="left" width="572" height="172"><p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>
		<img border="0" src="lab8a-22.gif"><p>&nbsp;<p align="center">Рисунок 20 
		- Процедуры и функции, формирующие файл с разделителями<p align="left">
		17.&nbsp; Откройте модуль формы напишите там аналогичный код, с той 
		разницей, что если в первом случае формируется текстовый файл по 
		информации справочника <b>Контрагенты</b>, а во во втором из справочника
		<b>Номенклатура</b>, рисунок 21-22. Этот код ни с какой кнопкой 
		связывать не надо, он выполняется автоматически при загрузке обработки.<p align="center">
		<img border="0" src="lab8a-17.jpg"><p align="center">Рисунок 21 - 
		Открыть модуль объекта<p align="center">&nbsp;<p align="center">
		<img border="0" src="lab8a-19.jpg" align="left"><img border="0" src="lab8a-23.gif" align="right"><p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="left">&nbsp;<p align="center">
		Рисунок 22 - Код модуля объекта<p align="left">18.&nbsp; После создания 
		обработки, сохраните все изменения, войдите в режим пользователя и 
		проверьте весь функционал. По указанному в коле адресу появятся два 
		файла с информацией из справочников Номенклатура и Контрагенты, рисунок 
		23.<p align="left"><img border="0" src="lab8a-20.jpg"><p align="center">
		Рисунок 23 - Созданные файлы с разделителями<p align="left">
		<i><b><font size="4"><a name="Контрольные_вопросы_№3_">Контрольные 
		вопросы №3</a></font></b></i><p align="left">
		1)&nbsp; Дайте характеристику формата файла <i><b>*.<span style="font-size: 12.0pt; line-height: 107%; font-family: 'Open Sans',sans-serif; color: black">CSV</span></b></i><p align="left">
		<span style="font-family: 'Open Sans',sans-serif">2)&nbsp; Какая 
		структура файла </span>
		<span style="font-size: 12.0pt; line-height: 107%; font-family: 'Open Sans',sans-serif; color: black; font-weight:700; font-style:italic">
		*.CSV?</span><p align="left">
		<span style="font-family: 'Open Sans',sans-serif">3)&nbsp; Каково 
		назначение процедуры <i><b>Имя</b></i></span><i><b>ФайлаНачалоВыбора()?</b></i><p align="left">
		4)&nbsp; Объясните алгоритм процедуры <i><b>Прочитать<span style="font-size: 12.0pt; line-height: 107%; font-family: 'Open Sans',sans-serif; color: black">CSV()
		</b></i>и<b><i> </i></b> </span> <b>ПрочитатьCSVНаСервере()</b><p align="left">
		<span style="font-family: 'Open Sans',sans-serif">5)&nbsp; Какую роль 
		играет процедура<b><i> </i></b></span><b>РазложитьСтрокуВМассивПодстрок()?</b><p align="left">
		6)&nbsp; Прокомментируйте алгоритм процедур&nbsp; и функций, формирующих 
		файл с разделителями<p align="left">
		7)&nbsp; Прокомментируйте код модуля объекта (рисунок 22)<p>&nbsp;</p>
		<p align="left">
		&nbsp;<p align="left">&nbsp;</td>
		<td valign="top" style="line-height: 100%; text-align: justify; text-indent: 15; margin-left: 8; margin-right: 5" height="9170">
		<!-- MSCellType="NavBody2" -->
		&nbsp;<blockquote>
			<p style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px">
			<em style="font-style: italic; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; outline: 0px; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin: 0px; padding: 0px">
			<strong style="font-style: inherit; font-variant: inherit; font-weight: 600; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; margin: 0px; padding: 0px">
			<a name="Обработка">Обработка&nbsp;</a></strong>– это специальный объект конфигурации, 
			предназначенный для изменения информации в базе данных или создания 
			нового функционала для администратора или пользователей, </em><em>
			например, с помощью обработки можно выполнять удаление из БД 
			устаревших данных или импортировать информацию из других систем и 
			т.д.</em></p>
			<p style="font-style: italic; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px">
			<em>Обработка может входить в состав конфигурации или быть внешней, 
			то есть храниться в отдельном файле с расширением <span lang="en-us">
			.epf </span>Файл с внешней обработкой может располагаться как внутри 
			БД так и за ее пределами, на любом носителе.</em></p>
			<p style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px">
			Для чего обработка предназначена и что будет выполнять – полностью 
			зависит от программиста, который ее пишет. По своим функциям все 
			обработки 1С можно условно разделить на следующие группы:</p>
			<ol style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; list-style-type: none; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 20px; padding: 0px">
				<li style="font-style: normal; font-variant: normal; font-weight: normal; overflow: hidden; position: relative; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 10px; padding-left: 23px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px">
				Отельные наборы функций и процедур, подобие объекта или класса. 
				Программисты могут использовать их как библиотеку или 
				пользоваться всеми прописанными в обработке кусками кода, если 
				включат ее в конфигурацию. В качестве примера можно привести 
				функции печати, объединенные разработчиками типовых конфигураций 
				в одном месте;</li>
				<li style="font-style: normal; font-variant: normal; font-weight: normal; overflow: hidden; position: relative; margin: 10px 0px; padding-left: 23px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px">
				Вспомогательные обработки. Выполняют автоматизацию небольшого 
				участка механической работы или предоставляют пользователям 
				данные в требуемом виде. Сюда входят автоматизированные рабочие 
				места, групповая обработка 1С документации, импорт или экспорт 
				данных и др.;</li>
				<li style="font-style: normal; font-variant: normal; font-weight: normal; overflow: hidden; position: relative; margin-left: 0px; margin-right: 0px; margin-top: 10px; margin-bottom: 0px; padding-left: 23px; padding-right: 0px; padding-top: 0px; padding-bottom: 0px">
				Дополнительные инструменты работы с данными. Это 
				специализированные обработки чаще всего позволяющие работать с 
				любой конфигурацией и базой данных.</li>
			</ol>
			<p style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px">
			Внешняя обработка 1С 8.3 второго и третьего типов очень часто 
			используется программистами в повседневной деятельности. Каждый 
			опытный разработчик 1С имеет свой набор «помощников» – отдельных 
			файлов с процедурами на все случаи жизни. Благодаря этому он 
			способен выполнять некоторые задачи лишь подправив пару строк кода: 
			загрузка или выгрузка данных, обработка справочника или документов, 
			формирование печатной формы – не составит труда для разработчиков.</p>
			<p style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; outline: 0px; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px">
			После того как программист решил создать обработку, ему необходимо 
			понять, куда ее нужно добавлять.&nbsp; Конфигуратор&nbsp;&nbsp; 
			поддерживает возможность добавления внешних&nbsp; обработок.</p>
			<p style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; outline: 0px; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px">&nbsp;Отличительная 
			черта внешней обработки&nbsp; заключается в отсутствии необходимости 
			изменять основную конфигурацию и, соответственно, упрощении 
			обновления. </p>
			<p style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; font-size: 16px; line-height: inherit; font-family: OpenSans, 'Trebuchet MS', sans-serif; color: rgb(64, 64, 64); letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; margin-left: 0px; margin-right: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px">&nbsp;</p>
			<br class="Apple-interchange-newline">
&nbsp;</blockquote>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p><b><i><font size="4" color="#6600CC">Во время отладки внешней 
		обработки не требуется закрытие программы в режиме пользователя. 
		Достаточно выполненные изменения сохранить (кнопка
		<img border="0" src="lab8a-5.gif"> на панели), затем переключиться в 
		режим пользователя и там выполнить последовательность&nbsp; Главное меню 
		- Файл - Открыть.</font></i></b><p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;</td>
	</tr>
	<tr>
		<td valign="top" colspan="2">
		<!-- MSCellType="ContentFoot" -->
		&nbsp;</td>
		<td height="65" width="271">&nbsp;</td>
	</tr>
</table>

</body>

</html>
